<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Dashboard â€¢ PIM</title>
  <style>
    :root {
      --bg:#0a0a0a; --sidebar:#111; --card:#1a1a1a;
      --ink:#f5f5f5; --muted:#bdbdbd; --accent:#fff;
    }
    body {margin:0;height:100vh;display:flex;background:var(--bg);color:var(--ink);font:15px system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    .sidebar {width:260px;background:var(--sidebar);padding:20px;display:flex;flex-direction:column;justify-content:space-between}
    .folders {margin-top:20px}
    .folder {padding:8px 10px;border-radius:8px;background:#222;margin-bottom:8px;cursor:pointer}
    .folder:hover {background:#333}
    .subfolder {margin-left:20px}
    .add-folder-btn {margin-top:12px;padding:8px;background:var(--accent);color:var(--bg);border:none;border-radius:6px;font-weight:bold;cursor:pointer}
    .profile {display:flex;flex-direction:column;align-items:center;margin-top:auto}
    .profile img {width:40px;height:40px;border-radius:50%;margin-bottom:10px}
    .logout {margin-top:10px;padding:12px 16px;width:100%;background:#222;color:var(--ink);border:none;border-radius:8px;font-size:15px;font-weight:bold;cursor:pointer}
    .logout:hover {background:#333}
    .main {flex:1;padding:20px;display:flex;flex-direction:column}
    .topbar {display:flex;justify-content:space-between;align-items:center}
    .search {padding:8px 10px;border-radius:8px;border:none;background:#1f1f1f;color:var(--ink);width:260px}
    .widgets {margin-top:20px;display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    .widget {background:var(--card);border-radius:12px;padding:20px;text-align:center;cursor:pointer;box-shadow:0 4px 10px rgba(0,0,0,.4)}
    .widget:hover {background:#222}
  </style>
</head>
<body>
  <div class="sidebar">
    <div>
      <h2>Folders</h2>
      <div class="folders" id="folderList"></div>
      <button class="add-folder-btn" id="addFolderBtn">+ Add Folder</button>
    </div>
    <div class="profile">
      <img src="https://ui-avatars.com/api/?name=User" alt="profile"/>
      <button class="logout" onclick="logout()">Logout</button>
    </div>
  </div>

  <div class="main">
    <div class="topbar">
      <h1>Dashboard</h1>
      <input type="text" class="search" placeholder="Search..."/>
    </div>
    <div class="widgets">
      <div class="widget" onclick="location.href='create_note.html'">Create Note</div>
      <div class="widget" onclick="location.href='notes.html'">View Notes</div>
      <div class="widget" onclick="location.href='view_folder.html'">View Folders</div>
      <div class="widget" onclick="location.href='todo.html'">Todo List</div>
      <div class="widget" onclick="location.href='stats.html'">Stats</div>
    </div>
  </div>

  <script>
    const username = localStorage.getItem("username") || "guest";
    const FOLDERS_KEY = `${username}_foldersTree`;
    const folderList = document.getElementById("folderList");
    const addFolderBtn = document.getElementById("addFolderBtn");

    function uid(){ return Math.random().toString(36).slice(2)+Date.now().toString(36); }
    function loadTree(){ return JSON.parse(localStorage.getItem(FOLDERS_KEY)||'[]'); }
    function saveTree(tree){ localStorage.setItem(FOLDERS_KEY,JSON.stringify(tree)); }

    function renderFolders(){
      folderList.innerHTML="";
      const tree=loadTree();
      tree.forEach(f=>folderList.appendChild(renderNode(f)));
    }

    function renderNode(node){
      const div=document.createElement("div");
      div.className="folder"; div.textContent=node.name;
      if(node.children?.length){
        node.children.forEach(c=>{
          const child=renderNode(c);
          child.classList.add("subfolder");
          div.appendChild(child);
        });
      }
      return div;
    }

    addFolderBtn.onclick=()=>{
      const name=prompt("Folder name:");
      if(!name)return;
      const tree=loadTree();
      tree.push({id:uid(),name,children:[]});
      saveTree(tree);
      renderFolders();
    };

    function logout(){
      localStorage.clear();
      location.href="login.html";
    }

    renderFolders();
  </script>
</body>
</html>