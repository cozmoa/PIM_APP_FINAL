<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Notes â€¢ PIM</title>
  <style>
    body { background:#0a0a0a; color:#f5f5f5; font-family:system-ui,sans-serif; padding:20px; }
    h1 { margin-bottom:20px; }
    .grid { display:grid; grid-template-columns:repeat(3,1fr); gap:16px; }
    .note {
      background:#1a1a1a;
      padding:16px;
      border-radius:12px;
      cursor:pointer;
      transition:background 0.2s ease;
    }
    .note:hover { background:#222; }
    .note h2 { margin:0 0 8px; font-size:18px; }
    .note p { font-size:14px; color:#bbb; overflow:hidden; white-space:nowrap; text-overflow:ellipsis; }
    /* Modal */
    .modal {
      display:none;
      position:fixed;
      top:0; left:0;
      width:100%; height:100%;
      background:rgba(0,0,0,0.7);
      justify-content:center;
      align-items:center;
    }
    .modal-content {
      background:#1a1a1a;
      padding:20px;
      border-radius:12px;
      width:500px;
      max-width:90%;
    }
    .modal-content h2 { margin-top:0; }
    .modal-content textarea {
      width:100%;
      height:200px;
      background:#111;
      color:#fff;
      border:none;
      border-radius:8px;
      padding:10px;
      margin-top:10px;
    }
    .actions { margin-top:10px; display:flex; gap:10px; }
    button {
      padding:8px 12px;
      border:none;
      border-radius:6px;
      cursor:pointer;
    }
    .save { background:#fff; color:#000; font-weight:bold; }
    .delete { background:#b33; color:#fff; }
    .close { background:#333; color:#fff; }
  </style>
</head>
<body>
  <h1>Your Notes</h1>
  <div class="grid" id="notesGrid"></div>

  <!-- Modal -->
  <div class="modal" id="noteModal">
    <div class="modal-content">
      <h2 id="modalTitle"></h2>
      <textarea id="modalContent"></textarea>
      <div class="actions">
        <button class="save" onclick="saveNote()">Save</button>
        <button class="delete" onclick="deleteNote()">Delete</button>
        <button class="close" onclick="closeModal()">Close</button>
      </div>
    </div>
  </div>

  <script>
    const username = localStorage.getItem("username") || "guest";
    let notes = JSON.parse(localStorage.getItem(username+"_notes") || "[]");
    const grid = document.getElementById("notesGrid");
    const modal = document.getElementById("noteModal");
    const modalTitle = document.getElementById("modalTitle");
    const modalContent = document.getElementById("modalContent");

    let currentIndex = null;

    function saveNotes() {
      localStorage.setItem(username+"_notes", JSON.stringify(notes));
    }

    function renderNotes() {
      grid.innerHTML = '';
      notes.forEach((note, i) => {
        const div = document.createElement("div");
        div.className = "note";
        div.innerHTML = `<h2>${note.title}</h2><p>${note.content}</p>`;
        div.onclick = () => openModal(i);
        grid.appendChild(div);
      });
    }

    function openModal(index) {
      currentIndex = index;
      modalTitle.textContent = notes[index].title;
      modalContent.value = notes[index].content;
      modal.style.display = "flex";
    }
    function closeModal() {
      modal.style.display = "none";
      currentIndex = null;
    }
    function saveNote() {
      if (currentIndex !== null) {
        notes[currentIndex].content = modalContent.value;
        saveNotes();
        renderNotes();
        closeModal();
      }
    }
    function deleteNote() {
      if (currentIndex !== null) {
        notes.splice(currentIndex,1);
        saveNotes();
        renderNotes();
        closeModal();
      }
    }

    renderNotes();
  </script>
</body>
</html>